rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
C = 10^-3,
Si = 5 * 10^-4,
p = 0.03,
alpha = 7.85,
gamma = 0.3
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
C = 10^-3,
Si = 5 * 10^-4,
p = 0.03,
alpha = 7.85,
gamma = 0.3
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
C = 10^-3,
Si = 5 * 10^-4,
p = 0.03,
alpha = 7.85,
gamma = 0.3
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
C = 10^-3,
Si = 5 * 10^-4,
p = 0.03,
alpha = 7.85,
gamma = 0.3
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
C = 10^-3,
Si = 5 * 10^-4,
p = 0.03,
alpha = 7.85,
gamma = 0.3
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
library(PBSddesolve)
library("deSolve")
#Minimal model function
minimal_model <- function(t, y, parameters) {
P1 = parameters[1]
P2 = parameters[2]
P3 = parameters[3]
n = parameters[4]
gamma = parameters[5]
h = parameters[6]
Gb = parameters[7]
Ib = parameters[8]
G = y[1]
X = y[2]
I = y[3]
# Glucose
dG <- -(P1 + X) * G + P1 * Gb
# Auxiliary variable X
dX <- -P2 * X + P3 * (I - Ib)
# Insuline
dI <- -n * (I - Ib) + gamma * t * pmax(G - h, 0)
return(list(c(dG, dX, dI)))
}
# Dynamic Model function
dynamic_model <- function(t, y, parameters) {
b0 <- parameters[1]
b1 <- parameters[2]
b2 <- parameters[3]
b3 <- parameters[4]
b4 <- parameters[5]
b5 <- parameters[6]
b6 <- parameters[7]
b7 <- parameters[8]
alpha <- parameters[9]
Gb <- parameters[10]
Ib <- parameters[11]
G <- y[1]
I <- y[2]
if (t < b5)
Glag <- Gb
else
Glag <- lagvalue(t - b5, 1)
dG <- -b1 * G - (b4 * I * G) / (alpha * G + 1) + b7
dI <- b6 * Glag - b2 * I
list(c(dG, dI))
}
u <- function(t) {
if (t %in% c(10, 14, 18)) {
return(4)
} else {
return(0)
}
}
# BetaIG Model function
BIG_model <- function(t, y, parameters) {
u0 <- parameters[1]
Si <- parameters[2]
C <- parameters[3]
p <- parameters[4]
gamma <- parameters[5]
mu_production <- parameters[6]
mu_removal <- parameters[7]
alfa <- parameters[8]
G <- y[1]
I <- y[2]
B <- y[3]
dG <- u0 + u(t) - (C + Si*I)*G
dI <- G^2/(alfa + G^2) * B * p - gamma * I
dB <- B * (mu_production * 1/(1 + (8.4/G)^1.7) - mu_removal * 1/(1 + (G/4.8)^8.5))
list(c(dG, dI, dB))
}
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
u0 <- parameters[1]
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
Si = 5 * 10^-4,
C = 10^-3,
p = 0.03,
gamma = 0.3,
mu_production = 0.021/(24 * 60),
mu_removal = 0.025/(24 * 60),
alfa = 7.85
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
Si = 5 * 10^-4,
C = 10^-3,
p = 0.03,
gamma = 0.3,
mu_production = 0.021/(24 * 60),
mu_removal = 0.025/(24 * 60),
alfa = 7.85
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
plot(out$time, out$I)
plot(out$time, out$I)
plot(out$time, out$I)
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
Si = 5 * 10^-4,
C = 10^-3,
p = 0.03,
gamma = 0.3,
mu_production = 0.021/(24 * 60),
mu_removal = 0.025/(24 * 60),
alfa = 7.85
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
options(device = "RStudioGD")
plot(out$time, out$I)
source("models.R")
#h(G) function
h_function <- function(G) {
0.021/(24*60) * 1/(1 + (8.4/G)^1.7) - 0.025/(24*60) * 1/(1 + (G/4.8)^8.5)
}
svg("h_function.svg", width=8, height = 6)
G_vals <- seq(0,10,0.03)
plot(G_vals, h_function(G_vals), xlab="Glucose (mM)", type="l", ylab="Change of beta cells functional mass")
title("h(G) function - beta cell production rate")
dev.off()
params <- c(
u0 = 1/30,
Si = 5 * 10^-4,
C = 10^-3,
p = 0.03,
gamma = 0.3,
mu_production = 0.021/(24 * 60),
mu_removal = 0.025/(24 * 60),
alfa = 7.85
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
options(device = "RStudioGD")
plot(out$time, out$I)
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
source("models.R")
#h(G) function
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
params <- c(
u0 = 1/30,
Si = 5 * 10^-4,
C = 10^-3,
p = 0.03,
gamma = 0.3,
mu_production = 0.021/(24 * 60),
mu_removal = 0.025/(24 * 60),
alfa = 7.85
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
params <- c(
u0 = 1/30,
Si = 5 * 10^-4,
C = 10^-3,
p = 0.03,
gamma = 0.3,
mu_production = 0.021/(24 * 60),
mu_removal = 0.025/(24 * 60),
alfa = 7.85
)
#BIG MODEL
init <- c(
G = 5,
I = 0.6,
B = 0.5
)
time <- seq(0, 140, by = 0.5)
out <- ode(
y = init,
times = time,
func = BIG_model,
parms = params,
rtol = 1e-9,
atol = 1e-9
)
colnames(out) <- c("time", "G", "I", "B")
out <- as.data.frame(out)
plot(out$time, out$I)
